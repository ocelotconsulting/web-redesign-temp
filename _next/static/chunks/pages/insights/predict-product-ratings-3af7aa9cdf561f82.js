(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[112],{5322:function(n,s){"use strict";s.DF={prefix:"fas",iconName:"calendar",icon:[448,512,[128197,128198],"f133","M96 32V64H48C21.5 64 0 85.5 0 112v48H448V112c0-26.5-21.5-48-48-48H352V32c0-17.7-14.3-32-32-32s-32 14.3-32 32V64H160V32c0-17.7-14.3-32-32-32S96 14.3 96 32zM448 192H0V464c0 26.5 21.5 48 48 48H400c26.5 0 48-21.5 48-48V192z"]},s.fT=s.DF},4691:function(n,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var e="circle-user",a=[62142,"user-circle"],t="f2bd",c="M399 384.2C376.9 345.8 335.4 320 288 320H224c-47.4 0-88.9 25.8-111 64.2c35.2 39.2 86.2 63.8 143 63.8s107.8-24.7 143-63.8zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zm256 16a72 72 0 1 0 0-144 72 72 0 1 0 0 144z";s.definition={prefix:"fas",iconName:e,icon:[512,512,a,t,c]},s.faCircleUser=s.definition,s.prefix="fas",s.iconName=e,s.width=512,s.height=512,s.ligatures=a,s.unicode=t,s.svgPathData=c,s.aliases=a},6529:function(n,s,e){"use strict";var a=e(4691);s.DF={prefix:a.prefix,iconName:a.iconName,icon:[a.width,a.height,a.aliases,a.unicode,a.svgPathData]},s.m0=s.DF,a.prefix,a.iconName,a.width,a.height,a.aliases,a.unicode,a.svgPathData,a.aliases},1646:function(n,s,e){(window.__NEXT_P=window.__NEXT_P||[]).push(["/insights/predict-product-ratings",function(){return e(1702)}])},2678:function(n,s,e){"use strict";e.d(s,{a:function(){return t}});var a=e(5893);function t(n){return{h1:n=>{let{children:s}=n;return(0,a.jsx)("h1",{className:"text-4xl font-bold text-black mb-4",children:s})},h2:n=>{let{children:s}=n;return(0,a.jsx)("h2",{className:"text-3xl font-bold text-black mb-4",children:s})},h3:n=>{let{children:s}=n;return(0,a.jsx)("h3",{className:"text-2xl font-bold text-black mb-4",children:s})},h4:n=>{let{children:s}=n;return(0,a.jsx)("h4",{className:"text-xl font-bold text-black mb-4",children:s})},h5:n=>{let{children:s}=n;return(0,a.jsx)("h5",{className:"text-lg font-bold text-black mb-4",children:s})},p:n=>{let{children:s}=n;return(0,a.jsx)("p",{className:"mb-4",children:s})},a:n=>{let{href:s,children:e}=n;return(0,a.jsx)("a",{style:{color:"#3273dc"},href:s,children:e})},ul:n=>{let{children:s}=n;return(0,a.jsx)("ul",{className:"mb-4 list-disc pl-4",children:s})},ol:n=>{let{children:s}=n;return(0,a.jsx)("ol",{className:"mb-4 list-decimal pl-4",children:s})},pre:n=>{let{children:s}=n;return(0,a.jsx)("pre",{className:"p-4 mb-4 bg-black",children:s})},...n}}},5802:function(n,s,e){"use strict";e.d(s,{Z:function(){return t}});var a=e(5893);function t(n){let{children:s,className:e="",containerClassName:t="",backLayer:c="",frontLayer:i="",fullWidth:r=!1,...l}=n;return(0,a.jsxs)("section",{className:"relative py-14 md:py-20 px-5 ".concat(e),...l,children:[c,(0,a.jsx)("div",{className:"relative ".concat(r?"":"container mx-auto"," ").concat(t),children:s}),i]})}},378:function(n,s,e){"use strict";e.d(s,{Z:function(){return p}});var a=e(5893),t=e(5802),c=e(7814),i=e(5322),r=e(6529),l=e(9008),o=e.n(l);function p(n){let{title:s,image:e,date:l,author:p,children:u,url:d}=n,h="https://www.ocelotconsulting.com";return h=window.location.origin,(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(o(),{children:[(0,a.jsx)("meta",{name:"author",content:p}),(0,a.jsx)("meta",{name:"description",content:s}),(0,a.jsx)("meta",{property:"og:description",content:s}),(0,a.jsx)("meta",{name:"twitter:description",content:s}),(0,a.jsx)("meta",{property:"og:type",content:"website"}),(0,a.jsx)("meta",{property:"og:title",content:s}),(0,a.jsx)("meta",{name:"twitter:card",content:"summary"}),(0,a.jsx)("meta",{name:"twitter:site",content:"@ocelot_llc"}),(0,a.jsx)("meta",{name:"twitter:title",content:s}),e?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("meta",{property:"og:url",content:"".concat(h).concat(d)}),(0,a.jsx)("meta",{property:"og:image",content:"".concat(h,"/assets/insights/").concat(e)}),(0,a.jsx)("meta",{name:"twitter:image",content:"".concat(h,"/assets/insights/").concat(e)})]}):null]}),(0,a.jsxs)(t.Z,{style:{backgroundImage:"url(/assets/insights/".concat(e,")")},className:"bg-cover bg-center md:min-h-[370px] flex flex-col justify-center",backLayer:(0,a.jsx)("div",{className:"absolute inset-0 bg-black/40"}),children:[(0,a.jsx)("h1",{className:"text-4xl md:text-7xl font-bold text-white md:text-left text-center",children:s}),(0,a.jsxs)("p",{className:"text-white",children:[(0,a.jsx)(c.G,{className:"text-accent mr-2",icon:i.fT}),l]}),(0,a.jsxs)("p",{className:"text-white",children:[(0,a.jsx)(c.G,{className:"text-accent mr-2",icon:r.m0}),"By ",p]})]}),(0,a.jsx)(t.Z,{children:u})]})}},1702:function(n,s,e){"use strict";e.r(s),e.d(s,{meta:function(){return i}});var a=e(5893),t=e(2678),c=e(378);let i={title:"Predict product Ratings with User-Based Collaborative Filtering",image:"2022-03-31-predict-product-ratings/mean_rating.gif",date:"2022-03-31 10:00:00",author:"Khuyen Tran",description:"Crossplane is an infrastructure-as-code tool that manages your infrastructure as Kubernetes objects and keeps state within Kubernetes, leveraging controllers and extensions for various cloud providers and their object types.",url:"/insights/predict-product-ratings"},r=function(n){let{children:s}=n;return(0,a.jsx)(c.Z,Object.assign({},i,{children:s}))};function l(n){let s=Object.assign({h2:"h2",p:"p",img:"img",a:"a",code:"code",div:"div",pre:"pre",span:"span",em:"em",strong:"strong"},(0,t.a)(),n.components);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.h2,{children:"Motivation"}),"\n",(0,a.jsx)(s.p,{children:"Imagine you have a database of product ratings from different users. There are some products in the system that your users haven’t bought. How do recommend new and relevant products to your users using this data?"}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{src:"/assets/insights/2022-03-31-predict-product-ratings/data.png",alt:""})}),"\n",(0,a.jsx)(s.p,{children:"One straightforward approach is to guess the rating of user 1 on a product using the rating of user 2 on the same product. To increase the chance of guessing it right, user 2 should have similar rating behaviors to user 1."}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{src:"/assets/insights/2022-03-31-predict-product-ratings/table.gif",alt:""})}),"\n",(0,a.jsx)(s.p,{children:"After predicting all ratings, we will then recommend user 1 the products that are predicted to be highly rated by user 1."}),"\n",(0,a.jsx)(s.p,{children:"The approach above is a simplified version of user-based collaborative filtering, where we use similarities between users to provide recommendations."}),"\n",(0,a.jsx)(s.p,{children:"In this article, we will use collaborative filtering to fill in the missing ratings on a real product database."}),"\n",(0,a.jsx)(s.h2,{children:"Get the Data"}),"\n",(0,a.jsxs)(s.p,{children:["We will work with a sample data I created. The data can be downloaded ",(0,a.jsx)(s.a,{href:"https://github.com/ocelotconsulting/cereal-rating/blob/main/data/cereal_ratings.csv",children:"here"}),"."]}),"\n",(0,a.jsxs)(s.p,{children:["After saving the data under the directory ",(0,a.jsx)(s.code,{children:"data"}),", load the data:"]}),"\n",(0,a.jsx)(s.div,{className:"remark-highlight",children:(0,a.jsx)(s.pre,{className:"language-python",children:(0,a.jsxs)(s.code,{className:"language-python",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"import"})," numpy ",(0,a.jsx)(s.span,{className:"token keyword",children:"as"})," np\n",(0,a.jsx)(s.span,{className:"token keyword",children:"import"})," pandas ",(0,a.jsx)(s.span,{className:"token keyword",children:"as"})," pd\nratings_df ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," pd",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"read_csv",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token string",children:"'../data/cereal_ratings.csv'"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," index_col",(0,a.jsx)(s.span,{className:"token operator",children:"="}),(0,a.jsx)(s.span,{className:"token number",children:"0"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),"\nratings_df\n"]})})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{src:"/assets/insights/2022-03-31-predict-product-ratings/data.png",alt:""})}),"\n",(0,a.jsx)(s.p,{children:"Note that there are some missing values in this data. We will start with finding the similarity between each pair of users."}),"\n",(0,a.jsx)(s.h2,{children:"Find Similarities Between Users"}),"\n",(0,a.jsxs)(s.p,{children:["We’ll use the ",(0,a.jsx)(s.a,{href:"https://en.wikipedia.org/wiki/Pearson_correlation_coefficient",children:"Pearson correlation coefficient"})," to find the correlation between users based on their rated products."]}),"\n",(0,a.jsx)(s.p,{children:"If two users give exactly the same ratings, the Pearson correlation is 1."}),"\n",(0,a.jsx)(s.div,{className:"remark-highlight",children:(0,a.jsx)(s.pre,{className:"language-python",children:(0,a.jsxs)(s.code,{className:"language-python",children:["user1 ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),(0,a.jsx)(s.span,{className:"token number",children:"0"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(s.span,{className:"token number",children:"1"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(s.span,{className:"token number",children:"2"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),"\nuser2 ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),(0,a.jsx)(s.span,{className:"token number",children:"0"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(s.span,{className:"token number",children:"1"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(s.span,{className:"token number",children:"2"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),"\nnp",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"corrcoef",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"user1",(0,a.jsx)(s.span,{className:"token punctuation",children:","})," user2",(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),(0,a.jsx)(s.span,{className:"token number",children:"0"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(s.span,{className:"token number",children:"1"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),"\n"]})})}),"\n",(0,a.jsx)(s.div,{className:"remark-highlight",children:(0,a.jsx)(s.pre,{className:"language-bash",children:(0,a.jsxs)(s.code,{className:"language-bash",children:[(0,a.jsx)(s.span,{className:"token number",children:"1.0"}),"\n"]})})}),"\n",(0,a.jsx)(s.p,{children:"If the relative product ratings of two users increase at the same rate, the correlation is still 1."}),"\n",(0,a.jsx)(s.div,{className:"remark-highlight",children:(0,a.jsx)(s.pre,{className:"language-python",children:(0,a.jsxs)(s.code,{className:"language-python",children:["user1 ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),(0,a.jsx)(s.span,{className:"token number",children:"0"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(s.span,{className:"token number",children:"1"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(s.span,{className:"token number",children:"2"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),"\nuser2 ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),(0,a.jsx)(s.span,{className:"token number",children:"0"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(s.span,{className:"token number",children:"2"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(s.span,{className:"token number",children:"4"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),"\nnp",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"corrcoef",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"user1",(0,a.jsx)(s.span,{className:"token punctuation",children:","})," user2",(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),"\n"]})})}),"\n",(0,a.jsx)(s.div,{className:"remark-highlight",children:(0,a.jsx)(s.pre,{className:"language-bash",children:(0,a.jsxs)(s.code,{className:"language-bash",children:[(0,a.jsx)(s.span,{className:"token number",children:"1.0"}),"\n"]})})}),"\n",(0,a.jsx)(s.p,{children:"If two users rate exactly opposite to each other, the correlation is -1."}),"\n",(0,a.jsx)(s.div,{className:"remark-highlight",children:(0,a.jsx)(s.pre,{className:"language-python",children:(0,a.jsxs)(s.code,{className:"language-python",children:["user1 ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),(0,a.jsx)(s.span,{className:"token number",children:"0"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(s.span,{className:"token number",children:"1"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(s.span,{className:"token number",children:"2"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(s.span,{className:"token number",children:"3"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),"\nuser2 ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),(0,a.jsx)(s.span,{className:"token number",children:"3"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(s.span,{className:"token number",children:"2"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(s.span,{className:"token number",children:"1"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(s.span,{className:"token number",children:"0"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),"\nnp",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"corrcoef",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"user1",(0,a.jsx)(s.span,{className:"token punctuation",children:","})," user2",(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),(0,a.jsx)(s.span,{className:"token number",children:"0"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(s.span,{className:"token number",children:"1"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),"\n"]})})}),"\n",(0,a.jsx)(s.div,{className:"remark-highlight",children:(0,a.jsx)(s.pre,{className:"language-bash",children:(0,a.jsxs)(s.code,{className:"language-bash",children:[(0,a.jsx)(s.span,{className:"token parameter variable",children:"-1"}),"\n"]})})}),"\n",(0,a.jsx)(s.p,{children:"Let’s use this method to create a function that finds a correlation between two users:"}),"\n",(0,a.jsx)(s.div,{className:"remark-highlight",children:(0,a.jsx)(s.pre,{className:"language-python",children:(0,a.jsxs)(s.code,{className:"language-python",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"def"})," ",(0,a.jsx)(s.span,{className:"token function",children:"find_correlation_between_two_users"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"ratings_df",(0,a.jsx)(s.span,{className:"token punctuation",children:":"})," pd",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"DataFrame",(0,a.jsx)(s.span,{className:"token punctuation",children:","})," user1",(0,a.jsx)(s.span,{className:"token punctuation",children:":"})," ",(0,a.jsx)(s.span,{className:"token builtin",children:"str"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," user2",(0,a.jsx)(s.span,{className:"token punctuation",children:":"})," ",(0,a.jsx)(s.span,{className:"token builtin",children:"str"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:":"}),"\n    ",(0,a.jsx)(s.span,{className:"token triple-quoted-string string",children:'"""Find correlation between two users based on their rated products using Pearson correlation"""'}),"\n    rated_products_by_both ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," ratings_df",(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),"user1",(0,a.jsx)(s.span,{className:"token punctuation",children:","})," user2",(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"dropna",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"axis",(0,a.jsx)(s.span,{className:"token operator",children:"="}),(0,a.jsx)(s.span,{className:"token number",children:"0"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"values\n    user1_ratings ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," rated_products_by_both",(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),(0,a.jsx)(s.span,{className:"token punctuation",children:":"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(s.span,{className:"token number",children:"0"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),"\n    user2_ratings ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," rated_products_by_both",(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),(0,a.jsx)(s.span,{className:"token punctuation",children:":"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(s.span,{className:"token number",children:"1"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),"\n    ",(0,a.jsx)(s.span,{className:"token keyword",children:"return"})," np",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"corrcoef",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"user1_ratings",(0,a.jsx)(s.span,{className:"token punctuation",children:","})," user2_ratings",(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),(0,a.jsx)(s.span,{className:"token number",children:"0"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(s.span,{className:"token number",children:"1"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),"\n"]})})}),"\n",(0,a.jsx)(s.p,{children:"Create a matrix that shows the similarities between all pairs of users:"}),"\n",(0,a.jsx)(s.div,{className:"remark-highlight",children:(0,a.jsx)(s.pre,{className:"language-python",children:(0,a.jsxs)(s.code,{className:"language-python",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"def"})," ",(0,a.jsx)(s.span,{className:"token function",children:"find_correlation_between_two_users"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"ratings_df",(0,a.jsx)(s.span,{className:"token punctuation",children:":"})," pd",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"DataFrame",(0,a.jsx)(s.span,{className:"token punctuation",children:","})," user1",(0,a.jsx)(s.span,{className:"token punctuation",children:":"})," ",(0,a.jsx)(s.span,{className:"token builtin",children:"str"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," user2",(0,a.jsx)(s.span,{className:"token punctuation",children:":"})," ",(0,a.jsx)(s.span,{className:"token builtin",children:"str"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:":"}),"\n    ",(0,a.jsx)(s.span,{className:"token triple-quoted-string string",children:'"""Find correlation between two users based on their rated products using Pearson correlation"""'}),"\n    rated_products_by_both ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," ratings_df",(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),"user1",(0,a.jsx)(s.span,{className:"token punctuation",children:","})," user2",(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"dropna",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"axis",(0,a.jsx)(s.span,{className:"token operator",children:"="}),(0,a.jsx)(s.span,{className:"token number",children:"0"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"values\n    user1_ratings ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," rated_products_by_both",(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),(0,a.jsx)(s.span,{className:"token punctuation",children:":"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(s.span,{className:"token number",children:"0"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),"\n    user2_ratings ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," rated_products_by_both",(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),(0,a.jsx)(s.span,{className:"token punctuation",children:":"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(s.span,{className:"token number",children:"1"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),"\n    ",(0,a.jsx)(s.span,{className:"token keyword",children:"return"})," np",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"corrcoef",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"user1_ratings",(0,a.jsx)(s.span,{className:"token punctuation",children:","})," user2_ratings",(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),(0,a.jsx)(s.span,{className:"token number",children:"0"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(s.span,{className:"token number",children:"1"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),"\n"]})})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{src:"https://miro.medium.com/max/700/1*ZlwVV22bKTzbva0QsN0GSA.png",alt:""})}),"\n",(0,a.jsx)(s.h2,{children:"Get Similar Users"}),"\n",(0,a.jsx)(s.p,{children:"Imagine we want to predict the rating of user 3 for product 1 based on the ratings of other users. We first want to select only the users who have rated product 1."}),"\n",(0,a.jsx)(s.div,{className:"remark-highlight",children:(0,a.jsx)(s.pre,{className:"language-python",children:(0,a.jsxs)(s.code,{className:"language-python",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"def"})," ",(0,a.jsx)(s.span,{className:"token function",children:"get_rated_user_for_a_product"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"ratings_df",(0,a.jsx)(s.span,{className:"token punctuation",children:":"})," pd",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"DataFrame",(0,a.jsx)(s.span,{className:"token punctuation",children:","})," product",(0,a.jsx)(s.span,{className:"token punctuation",children:":"})," ",(0,a.jsx)(s.span,{className:"token builtin",children:"str"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:":"}),"\n    ",(0,a.jsx)(s.span,{className:"token keyword",children:"return"})," ratings_df",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"loc",(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),"product",(0,a.jsx)(s.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:":"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"dropna",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"index",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"values\n"]})})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{src:"/assets/insights/2022-03-31-predict-product-ratings/get_rated_users.gif",alt:""})}),"\n",(0,a.jsxs)(s.p,{children:["Next, we only pick the ",(0,a.jsx)(s.em,{children:"k"})," number of users that are the most similar to user 3. We call these ",(0,a.jsx)(s.em,{children:"k"})," number of users the ",(0,a.jsx)(s.em,{children:"neighbors"})," of user 3."]}),"\n",(0,a.jsx)(s.div,{className:"remark-highlight",children:(0,a.jsx)(s.pre,{className:"language-python",children:(0,a.jsxs)(s.code,{className:"language-python",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"def"})," ",(0,a.jsx)(s.span,{className:"token function",children:"get_top_neighbors"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"similarity_df",(0,a.jsx)(s.span,{className:"token punctuation",children:":"})," pd",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"DataFrame",(0,a.jsx)(s.span,{className:"token punctuation",children:","})," user",(0,a.jsx)(s.span,{className:"token punctuation",children:":"})," ",(0,a.jsx)(s.span,{className:"token builtin",children:"str"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," rated_users",(0,a.jsx)(s.span,{className:"token punctuation",children:":"})," ",(0,a.jsx)(s.span,{className:"token builtin",children:"str"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," n_neighbors",(0,a.jsx)(s.span,{className:"token punctuation",children:":"})," ",(0,a.jsx)(s.span,{className:"token builtin",children:"int"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:":"}),"\n    ",(0,a.jsx)(s.span,{className:"token keyword",children:"return"})," similarity_df",(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),"user",(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),"rated_users",(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"nlargest",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"n_neighbors",(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"to_dict",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),"\n"]})})}),"\n",(0,a.jsx)(s.p,{children:"In the example below, we set the number of neighbors to be 2."}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{src:"/assets/insights/2022-03-31-predict-product-ratings/get_neighbors.gif",alt:""})}),"\n",(0,a.jsx)(s.h2,{children:"Get the Ratings of the Similar Users on a product"}),"\n",(0,a.jsxs)(s.p,{children:["Since different users might have different rating scales for the product that they like, we want to adjust for this bias by ",(0,a.jsx)(s.strong,{children:"subtracting"})," a rating of a user for ",(0,a.jsx)(s.strong,{children:"a product"})," by the ",(0,a.jsx)(s.strong,{children:"mean"})," ratings of that user for ",(0,a.jsx)(s.strong,{children:"all products"}),"."]}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{src:"/assets/insights/2022-03-31-predict-product-ratings/why_5_stars.png",alt:""})}),"\n",(0,a.jsx)(s.p,{children:"This means the rating of user \uD835\uDC63 for the product \uD835\uDC56 after adjusting for bias is:"}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{src:"https://miro.medium.com/max/653/1*D_Ty6HEsuHFUCCUaayqbMQ.png",alt:""})}),"\n",(0,a.jsx)(s.div,{className:"remark-highlight",children:(0,a.jsx)(s.pre,{className:"language-python",children:(0,a.jsxs)(s.code,{className:"language-python",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"def"})," ",(0,a.jsx)(s.span,{className:"token function",children:"subtract_bias"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"rating",(0,a.jsx)(s.span,{className:"token punctuation",children:":"})," ",(0,a.jsx)(s.span,{className:"token builtin",children:"float"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," mean_rating",(0,a.jsx)(s.span,{className:"token punctuation",children:":"})," ",(0,a.jsx)(s.span,{className:"token builtin",children:"float"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:":"}),"\n    ",(0,a.jsx)(s.span,{className:"token keyword",children:"return"})," rating ",(0,a.jsx)(s.span,{className:"token operator",children:"-"})," mean_rating\n\n\n",(0,a.jsx)(s.span,{className:"token keyword",children:"def"})," ",(0,a.jsx)(s.span,{className:"token function",children:"get_neighbor_rating_without_bias_per_product"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"\n    ratings_df",(0,a.jsx)(s.span,{className:"token punctuation",children:":"})," pd",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"DataFrame",(0,a.jsx)(s.span,{className:"token punctuation",children:","})," user",(0,a.jsx)(s.span,{className:"token punctuation",children:":"})," ",(0,a.jsx)(s.span,{className:"token builtin",children:"str"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," product",(0,a.jsx)(s.span,{className:"token punctuation",children:":"})," ",(0,a.jsx)(s.span,{className:"token builtin",children:"str"}),"\n",(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:":"}),"\n    ",(0,a.jsx)(s.span,{className:"token triple-quoted-string string",children:'"""Substract the rating of a user from the mean rating of that user to eliminate bias"""'}),"\n    mean_rating ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," ratings_df",(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),"user",(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"mean",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),"\n    rating ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," ratings_df",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"loc",(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),"product",(0,a.jsx)(s.span,{className:"token punctuation",children:","})," user",(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),"\n    ",(0,a.jsx)(s.span,{className:"token keyword",children:"return"})," subtract_bias",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"rating",(0,a.jsx)(s.span,{className:"token punctuation",children:","})," mean_rating",(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),"\n    \n",(0,a.jsx)(s.span,{className:"token keyword",children:"def"})," ",(0,a.jsx)(s.span,{className:"token function",children:"get_ratings_of_neighbors"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"ratings_df",(0,a.jsx)(s.span,{className:"token punctuation",children:":"})," pd",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"DataFrame",(0,a.jsx)(s.span,{className:"token punctuation",children:","})," neighbors",(0,a.jsx)(s.span,{className:"token punctuation",children:":"})," ",(0,a.jsx)(s.span,{className:"token builtin",children:"list"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," product",(0,a.jsx)(s.span,{className:"token punctuation",children:":"})," ",(0,a.jsx)(s.span,{className:"token builtin",children:"str"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:":"}),"\n    ",(0,a.jsx)(s.span,{className:"token triple-quoted-string string",children:'"""Get the ratings of all neighbors after adjusting for biases"""'}),"\n    ",(0,a.jsx)(s.span,{className:"token keyword",children:"return"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),"\n        get_neighbor_rating_without_bias_per_product",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"ratings_df",(0,a.jsx)(s.span,{className:"token punctuation",children:","})," neighbor",(0,a.jsx)(s.span,{className:"token punctuation",children:","})," product",(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),"\n        ",(0,a.jsx)(s.span,{className:"token keyword",children:"for"})," neighbor ",(0,a.jsx)(s.span,{className:"token keyword",children:"in"})," neighbors\n    ",(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),"\n"]})})}),"\n",(0,a.jsx)(s.p,{children:"In the GIF below, since the mean rating of user 1 for all products is 1, we subtract the rating of user 1 for product 1 by 1. Since the mean rating of user 2 for all products is 4, we subtract the rating of user 2 for product 1 by 4."}),"\n",(0,a.jsx)(s.p,{children:"Thus, the new ratings of users 1 and 2 for product 1 after adjusting for biases will be 2 stars and 1 star respectively."}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{src:"https://miro.medium.com/max/700/1*DpsCOnS3UGClToxXxFm5Sg.gif",alt:""})}),"\n",(0,a.jsx)(s.h2,{children:"Get the Rating of a User for a product Based on the Ratings of Similar Users"}),"\n",(0,a.jsx)(s.h2,{children:(0,a.jsx)(s.strong,{children:"Get the Rating Before Adjusting for Bias"})}),"\n",(0,a.jsx)(s.p,{children:"The rating of user \uD835\uDC62 for product \uD835\uDC56 before adjusting for the bias is calculated by taking the weighted average of the ratings for product \uD835\uDC56 from all neighbors \uD835\uDC63."}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{src:"https://miro.medium.com/max/700/1*ryRNWZgC7Pqesd9ueoObyg.png",alt:""})}),"\n",(0,a.jsx)(s.div,{className:"remark-highlight",children:(0,a.jsx)(s.pre,{className:"language-python",children:(0,a.jsxs)(s.code,{className:"language-python",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"def"})," ",(0,a.jsx)(s.span,{className:"token function",children:"get_weighted_average_rating_of_neighbors"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"ratings",(0,a.jsx)(s.span,{className:"token punctuation",children:":"})," ",(0,a.jsx)(s.span,{className:"token builtin",children:"list"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," neighbor_distance",(0,a.jsx)(s.span,{className:"token punctuation",children:":"})," ",(0,a.jsx)(s.span,{className:"token builtin",children:"list"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:":"}),"\n    weighted_sum ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," np",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"array",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"ratings",(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"dot",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"np",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"array",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"neighbor_distance",(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),"\n    abs_neigbor_distance ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," np",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token builtin",children:"abs"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"neighbor_distance",(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),"\n    ",(0,a.jsx)(s.span,{className:"token keyword",children:"return"})," weighted_sum ",(0,a.jsx)(s.span,{className:"token operator",children:"/"})," np",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),(0,a.jsx)(s.span,{className:"token builtin",children:"sum"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"abs_neigbor_distance",(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),"\n"]})})}),"\n",(0,a.jsx)(s.p,{children:"For example, the similarity of user 1 and user 3 is 0.8. The rating of user 1 for product 1 is 2. We multiply the adjusting rating of user 1 by their similarity of 0.8."}),"\n",(0,a.jsx)(s.p,{children:"We can do the similar calculation for user 2. The table below summarizes the calculations."}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{src:"/assets/insights/2022-03-31-predict-product-ratings/table2.png",alt:""})}),"\n",(0,a.jsx)(s.p,{children:"We then divide the sum of these weighted ratings by the sum of 0.8 and 0.5."}),"\n",(0,a.jsx)(s.p,{children:"The result of this calculation is the rating of user 3 for product 1 before adjusting for the bias."}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{src:"https://miro.medium.com/max/700/1*xmxqBSacjmORm07sW6W8Uw.gif",alt:""})}),"\n",(0,a.jsx)(s.h2,{children:"Get the Rating After Adjusting for Bias"}),"\n",(0,a.jsx)(s.p,{children:"Remember that we subtract the rating of each neighbor for a product by their mean rating to remove their bias?"}),"\n",(0,a.jsx)(s.p,{children:"To get the expected rating of user \uD835\uDC62 for product \uD835\uDC56, we will add the mean rating of user \uD835\uDC62 to the expected rating of user \uD835\uDC62 for product \uD835\uDC56 before adjusting for bias."}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{src:"https://miro.medium.com/max/648/1*4FR78m5gloOZ64w9VG1e3Q.png",alt:""})}),"\n",(0,a.jsx)(s.div,{className:"remark-highlight",children:(0,a.jsx)(s.pre,{className:"language-python",children:(0,a.jsxs)(s.code,{className:"language-python",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"def"})," ",(0,a.jsx)(s.span,{className:"token function",children:"ger_user_rating"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"ratings_df",(0,a.jsx)(s.span,{className:"token punctuation",children:":"})," pd",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"DataFrame",(0,a.jsx)(s.span,{className:"token punctuation",children:","})," user",(0,a.jsx)(s.span,{className:"token punctuation",children:":"})," ",(0,a.jsx)(s.span,{className:"token builtin",children:"str"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," avg_neighbor_rating",(0,a.jsx)(s.span,{className:"token punctuation",children:":"})," ",(0,a.jsx)(s.span,{className:"token builtin",children:"float"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:":"}),"\n    user_avg_rating ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," ratings_df",(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),"user",(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"mean",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),"\n    ",(0,a.jsx)(s.span,{className:"token keyword",children:"return"})," ",(0,a.jsx)(s.span,{className:"token builtin",children:"round"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"user_avg_rating ",(0,a.jsx)(s.span,{className:"token operator",children:"+"})," avg_neighbor_rating",(0,a.jsx)(s.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(s.span,{className:"token number",children:"2"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),"\n"]})})}),"\n",(0,a.jsx)(s.p,{children:"In the GIF below, the expected rating of user 3 for product 1 before adjusting for bias is 1.61, and the mean rating of user 3 for all products is 2. Taking the sum of 1.61 and 2 will give us 3.61."}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{src:"/assets/insights/2022-03-31-predict-product-ratings/mean_rating.gif",alt:""})}),"\n",(0,a.jsx)(s.h2,{children:"Get the Missing Ratings of All Users"}),"\n",(0,a.jsxs)(s.p,{children:["Now we are ready to put all of the functions shown above into the function ",(0,a.jsx)(s.code,{children:"predict_rating"})," . This function predicts the rating of a user for a product based on the ratings of that user’s neighbors."]}),"\n",(0,a.jsx)(s.div,{className:"remark-highlight",children:(0,a.jsx)(s.pre,{className:"language-python",children:(0,a.jsxs)(s.code,{className:"language-python",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"def"})," ",(0,a.jsx)(s.span,{className:"token function",children:"predict_rating"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"\n    df",(0,a.jsx)(s.span,{className:"token punctuation",children:":"})," pd",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"DataFrame",(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n    similarity_df",(0,a.jsx)(s.span,{className:"token punctuation",children:":"})," pd",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"DataFrame",(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n    user",(0,a.jsx)(s.span,{className:"token punctuation",children:":"})," ",(0,a.jsx)(s.span,{className:"token builtin",children:"str"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n    product",(0,a.jsx)(s.span,{className:"token punctuation",children:":"})," ",(0,a.jsx)(s.span,{className:"token builtin",children:"str"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n    n_neighbors",(0,a.jsx)(s.span,{className:"token punctuation",children:":"})," ",(0,a.jsx)(s.span,{className:"token builtin",children:"int"})," ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," ",(0,a.jsx)(s.span,{className:"token number",children:"2"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n",(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:":"}),"\n    ",(0,a.jsx)(s.span,{className:"token triple-quoted-string string",children:'"""Predict the rating of a user for a product based on the ratings of neighbors"""'}),"\n    ratings_df ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," df",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"copy",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),"\n\n    rated_users ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," get_rated_user_for_a_product",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"ratings_df",(0,a.jsx)(s.span,{className:"token punctuation",children:","})," product",(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),"\n\n    top_neighbors_distance ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," get_top_neighbors",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"\n        similarity_df",(0,a.jsx)(s.span,{className:"token punctuation",children:","})," user",(0,a.jsx)(s.span,{className:"token punctuation",children:","})," rated_users",(0,a.jsx)(s.span,{className:"token punctuation",children:","})," n_neighbors\n    ",(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),"\n    neighbors",(0,a.jsx)(s.span,{className:"token punctuation",children:","})," distance ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," top_neighbors_distance",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"keys",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," top_neighbors_distance",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"values",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),"\n\n    ",(0,a.jsx)(s.span,{className:"token keyword",children:"print"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsxs)(s.span,{className:"token string-interpolation",children:[(0,a.jsx)(s.span,{className:"token string",children:'f"Top '}),(0,a.jsxs)(s.span,{className:"token interpolation",children:[(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"n_neighbors",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"})]}),(0,a.jsx)(s.span,{className:"token string",children:" neighbors of user "}),(0,a.jsxs)(s.span,{className:"token interpolation",children:[(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"user",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"})]}),(0,a.jsx)(s.span,{className:"token string",children:", "}),(0,a.jsxs)(s.span,{className:"token interpolation",children:[(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"product",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"})]}),(0,a.jsx)(s.span,{className:"token string",children:": "}),(0,a.jsxs)(s.span,{className:"token interpolation",children:[(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),(0,a.jsx)(s.span,{className:"token builtin",children:"list"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"neighbors",(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"}"})]}),(0,a.jsx)(s.span,{className:"token string",children:'"'})]}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),"\n\n    ratings ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," get_ratings_of_neighbors",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"ratings_df",(0,a.jsx)(s.span,{className:"token punctuation",children:","})," neighbors",(0,a.jsx)(s.span,{className:"token punctuation",children:","})," product",(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),"\n    avg_neighbor_rating ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," get_weighted_average_rating_of_neighbors",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"\n        ratings",(0,a.jsx)(s.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(s.span,{className:"token builtin",children:"list"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"distance",(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),"\n    ",(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),"\n\n    ",(0,a.jsx)(s.span,{className:"token keyword",children:"return"})," ger_user_rating",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"ratings_df",(0,a.jsx)(s.span,{className:"token punctuation",children:","})," user",(0,a.jsx)(s.span,{className:"token punctuation",children:","})," avg_neighbor_rating",(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),"\n"]})})}),"\n",(0,a.jsxs)(s.p,{children:["Use the ",(0,a.jsx)(s.code,{children:"predict_rating"})," function to predict the ratings of all missing ratings:"]}),"\n",(0,a.jsx)(s.div,{className:"remark-highlight",children:(0,a.jsx)(s.pre,{className:"language-python",children:(0,a.jsxs)(s.code,{className:"language-python",children:["full_ratings ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," ratings_df",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"copy",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),"\n\n",(0,a.jsx)(s.span,{className:"token keyword",children:"for"})," user",(0,a.jsx)(s.span,{className:"token punctuation",children:","})," products ",(0,a.jsx)(s.span,{className:"token keyword",children:"in"})," full_ratings",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"iteritems",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:":"}),"\n    ",(0,a.jsx)(s.span,{className:"token keyword",children:"for"})," product ",(0,a.jsx)(s.span,{className:"token keyword",children:"in"})," products",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"keys",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:":"}),"\n        ",(0,a.jsx)(s.span,{className:"token keyword",children:"if"})," np",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"isnan",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"full_ratings",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"loc",(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),"product",(0,a.jsx)(s.span,{className:"token punctuation",children:","})," user",(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),(0,a.jsx)(s.span,{className:"token punctuation",children:":"}),"\n            full_ratings",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"loc",(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),"product",(0,a.jsx)(s.span,{className:"token punctuation",children:","})," user",(0,a.jsx)(s.span,{className:"token punctuation",children:"]"})," ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," predict_rating",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),"\n                ratings_df",(0,a.jsx)(s.span,{className:"token punctuation",children:","})," similarity_df",(0,a.jsx)(s.span,{className:"token punctuation",children:","})," user",(0,a.jsx)(s.span,{className:"token punctuation",children:","})," product\n            ",(0,a.jsx)(s.span,{className:"token punctuation",children:")"}),"\n"]})})}),"\n",(0,a.jsx)(s.div,{className:"remark-highlight",children:(0,a.jsx)(s.pre,{className:"language-bash",children:(0,a.jsxs)(s.code,{className:"language-bash",children:["Top ",(0,a.jsx)(s.span,{className:"token number",children:"2"})," neighbors of user ",(0,a.jsx)(s.span,{className:"token number",children:"30"}),", All-Bran: ",(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),(0,a.jsx)(s.span,{className:"token string",children:"'509'"}),", ",(0,a.jsx)(s.span,{className:"token string",children:"'15'"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),"\nTop ",(0,a.jsx)(s.span,{className:"token number",children:"2"})," neighbors of user ",(0,a.jsx)(s.span,{className:"token number",children:"311"}),", Apple Cinnamon Cheerios: ",(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),(0,a.jsx)(s.span,{className:"token string",children:"'452'"}),", ",(0,a.jsx)(s.span,{className:"token string",children:"'73'"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),"\nTop ",(0,a.jsx)(s.span,{className:"token number",children:"2"})," neighbors of user ",(0,a.jsx)(s.span,{className:"token number",children:"311"}),", Cap",(0,a.jsx)(s.span,{className:"token string",children:"'n'"}),"Crunch: ",(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),(0,a.jsx)(s.span,{className:"token string",children:"'452'"}),", ",(0,a.jsx)(s.span,{className:"token string",children:"'73'"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),"\nTop ",(0,a.jsx)(s.span,{className:"token number",children:"2"})," neighbors of user ",(0,a.jsx)(s.span,{className:"token number",children:"452"}),", ",(0,a.jsx)(s.span,{className:"token number",children:"100"}),"% Bran: ",(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),(0,a.jsx)(s.span,{className:"token string",children:"'468'"}),", ",(0,a.jsx)(s.span,{className:"token string",children:"'311'"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),"\nTop ",(0,a.jsx)(s.span,{className:"token number",children:"2"})," neighbors of user ",(0,a.jsx)(s.span,{className:"token number",children:"452"}),", All-Bran with Extra Fiber: ",(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),(0,a.jsx)(s.span,{className:"token string",children:"'468'"}),", ",(0,a.jsx)(s.span,{className:"token string",children:"'311'"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),"\nTop ",(0,a.jsx)(s.span,{className:"token number",children:"2"})," neighbors of user ",(0,a.jsx)(s.span,{className:"token number",children:"452"}),", Cinnamon Toast Crunch: ",(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),(0,a.jsx)(s.span,{className:"token string",children:"'468'"}),", ",(0,a.jsx)(s.span,{className:"token string",children:"'311'"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),"\nTop ",(0,a.jsx)(s.span,{className:"token number",children:"2"})," neighbors of user ",(0,a.jsx)(s.span,{className:"token number",children:"452"}),", Clusters: ",(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),(0,a.jsx)(s.span,{className:"token string",children:"'468'"}),", ",(0,a.jsx)(s.span,{className:"token string",children:"'311'"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),"\nTop ",(0,a.jsx)(s.span,{className:"token number",children:"2"})," neighbors of user ",(0,a.jsx)(s.span,{className:"token number",children:"452"}),", Cocoa Puffs: ",(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),(0,a.jsx)(s.span,{className:"token string",children:"'468'"}),", ",(0,a.jsx)(s.span,{className:"token string",children:"'311'"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),"\nTop ",(0,a.jsx)(s.span,{className:"token number",children:"2"})," neighbors of user ",(0,a.jsx)(s.span,{className:"token number",children:"468"}),", Bran Flakes: ",(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),(0,a.jsx)(s.span,{className:"token string",children:"'452'"}),", ",(0,a.jsx)(s.span,{className:"token string",children:"'624'"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),"\nTop ",(0,a.jsx)(s.span,{className:"token number",children:"2"})," neighbors of user ",(0,a.jsx)(s.span,{className:"token number",children:"547"}),", ",(0,a.jsx)(s.span,{className:"token number",children:"100"}),"% Natural Bran: ",(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),(0,a.jsx)(s.span,{className:"token string",children:"'509'"}),", ",(0,a.jsx)(s.span,{className:"token string",children:"'468'"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),"\nTop ",(0,a.jsx)(s.span,{className:"token number",children:"2"})," neighbors of user ",(0,a.jsx)(s.span,{className:"token number",children:"547"}),", Basic ",(0,a.jsx)(s.span,{className:"token number",children:"4"}),": ",(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),(0,a.jsx)(s.span,{className:"token string",children:"'509'"}),", ",(0,a.jsx)(s.span,{className:"token string",children:"'468'"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),"\nTop ",(0,a.jsx)(s.span,{className:"token number",children:"2"})," neighbors of user ",(0,a.jsx)(s.span,{className:"token number",children:"547"}),", Cheerios: ",(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),(0,a.jsx)(s.span,{className:"token string",children:"'509'"}),", ",(0,a.jsx)(s.span,{className:"token string",children:"'468'"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),"\nTop ",(0,a.jsx)(s.span,{className:"token number",children:"2"})," neighbors of user ",(0,a.jsx)(s.span,{className:"token number",children:"624"}),", Almond Delight: ",(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),(0,a.jsx)(s.span,{className:"token string",children:"'468'"}),", ",(0,a.jsx)(s.span,{className:"token string",children:"'509'"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),"\nTop ",(0,a.jsx)(s.span,{className:"token number",children:"2"})," neighbors of user ",(0,a.jsx)(s.span,{className:"token number",children:"624"}),", Apple Jacks: ",(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),(0,a.jsx)(s.span,{className:"token string",children:"'468'"}),", ",(0,a.jsx)(s.span,{className:"token string",children:"'509'"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),"\nTop ",(0,a.jsx)(s.span,{className:"token number",children:"2"})," neighbors of user ",(0,a.jsx)(s.span,{className:"token number",children:"73"}),", Bran Chex: ",(0,a.jsx)(s.span,{className:"token punctuation",children:"["}),(0,a.jsx)(s.span,{className:"token string",children:"'311'"}),", ",(0,a.jsx)(s.span,{className:"token string",children:"'509'"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"]"}),"\n"]})})}),"\n",(0,a.jsx)(s.p,{children:"Let’s take a look at the rating database after filling in all missing ratings:"}),"\n",(0,a.jsx)(s.div,{className:"remark-highlight",children:(0,a.jsx)(s.pre,{className:"language-python",children:(0,a.jsx)(s.code,{className:"language-python",children:"full_ratings\n"})})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{src:"/assets/insights/2022-03-31-predict-product-ratings/full_rating.png",alt:""})}),"\n",(0,a.jsx)(s.p,{children:"Pretty cool! Now we can suggest the products that are predicted to be highly rated to the users who haven’t watched those products before."}),"\n",(0,a.jsx)(s.h2,{children:"Conclusion"}),"\n",(0,a.jsx)(s.p,{children:"You have just learned how to predict product ratings based on user-based collaborative filtering. I hope this article will give you the motivation to create your own recommendation system."}),"\n",(0,a.jsxs)(s.p,{children:["Feel free to play and fork the source code of this article ",(0,a.jsx)(s.a,{href:"https://github.com/ocelotconsulting/cereal-rating",children:"here"}),"."]}),"\n",(0,a.jsx)(s.h2,{children:"Reference"}),"\n",(0,a.jsxs)(s.p,{children:["Katsov, I. (2018). ",(0,a.jsx)(s.em,{children:"Introduction to algorithmic marketing"}),". Ilya Katsov."]})]})}s.default=function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.jsx)(r,Object.assign({},n,{children:(0,a.jsx)(l,n)}))}}},function(n){n.O(0,[774,888,179],function(){return n(n.s=1646)}),_N_E=n.O()}]);